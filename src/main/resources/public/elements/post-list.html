<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../post-service/post-service.html">
<link rel="import" href="post-card.html">

<polymer-element name="post-list" attributes="show">
    <template>
        <style>
            :host {
                display: block;
                width: 100%;
            }

            post-card {
                margin-bottom: 30px;
            }
        </style>

        <post-service id="service" posts="{{posts}}"></post-service>

        <div layout vertical center>
            <template repeat="{{post in posts}}">
                <post-card
                        important="{{post.important}}"
                        on-important-tap="{{handleImportant}}"
                        on-delete-tap="{{handleDelete}}"
                        hidden?="{{show == 'important' && !post.important}}">
                <img src="{{post.avatar}}" width="70" height="70">

                <h2>{{post.title}}</h2>

                <p>{{post.text}}</p>
                </post-card>
            </template>
        </div>
    </template>

    <script>
        Polymer({
            handleImportant: function (event, detail, sender) {
                var post = sender.templateInstance.model.post;
                this.$.service.setImportant(post.id, post.important);
            },
            handleDelete: function (event, detail, sender) {
                var post = sender.templateInstance.model.post;
                this.$.service.deleteNote(post.id,this.posts);
            }
        });
    </script>
</polymer-element>
